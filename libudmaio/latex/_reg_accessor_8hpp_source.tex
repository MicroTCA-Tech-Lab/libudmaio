\hypertarget{_reg_accessor_8hpp_source}{}\doxysection{Reg\+Accessor.\+hpp}
\label{_reg_accessor_8hpp_source}\index{RegAccessor.hpp@{RegAccessor.hpp}}
\mbox{\hyperlink{_reg_accessor_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{2 }
\DoxyCodeLine{3 \textcolor{preprocessor}{\#include <cstdint>}}
\DoxyCodeLine{4 }
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_uio_if_8hpp}{udmaio/UioIf.hpp}}"{}}}
\DoxyCodeLine{6 }
\DoxyCodeLine{7 \textcolor{preprocessor}{\#ifndef REG\_PACKED\_ALIGNED}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#define REG\_PACKED\_ALIGNED \_\_attribute\_\_((packed, aligned(4)))}}
\DoxyCodeLine{9 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10 }
\DoxyCodeLine{11 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceudmaio}{udmaio}} \{}
\DoxyCodeLine{12 }
\DoxyCodeLine{18 \textcolor{keyword}{template} <\textcolor{keyword}{typename} C, \textcolor{keyword}{typename} U>}
\DoxyCodeLine{19 \textcolor{keyword}{class }\mbox{\hyperlink{classudmaio_1_1_reg_accessor_base}{RegAccessorBase}} \{}
\DoxyCodeLine{20   \textcolor{keyword}{protected}:}
\DoxyCodeLine{21     \textcolor{keyword}{using }\mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_a15e3cc0b449b7630cbee38f95714c2ce}{bus\_type\_t}} = \textcolor{keyword}{typename} U::UioIfBusType;}
\DoxyCodeLine{22     \textcolor{keyword}{static\_assert}((\textcolor{keyword}{sizeof}(C) \% \textcolor{keyword}{sizeof}(\mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_a15e3cc0b449b7630cbee38f95714c2ce}{bus\_type\_t}})) == 0,}
\DoxyCodeLine{23                   \textcolor{stringliteral}{"{}Register size must be a aligned to bus access width"{}});}
\DoxyCodeLine{24 }
\DoxyCodeLine{25     U* \mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_aacad53049524692810e6f78545bb4ae9}{\_if}};}
\DoxyCodeLine{26 }
\DoxyCodeLine{32     C \mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_a6533971f0b802d7a96e57621e1e585c7}{\_rd}}(uint32\_t offs)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{33         C result;}
\DoxyCodeLine{34         \mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_a15e3cc0b449b7630cbee38f95714c2ce}{bus\_type\_t}}* ptr = \textcolor{keyword}{reinterpret\_cast<}\mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_a15e3cc0b449b7630cbee38f95714c2ce}{bus\_type\_t}}*\textcolor{keyword}{>}(\&result);}
\DoxyCodeLine{35         \textcolor{keywordflow}{for} (uint32\_t i = 0; i < \textcolor{keyword}{sizeof}(C); i += \textcolor{keyword}{sizeof}(\mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_a15e3cc0b449b7630cbee38f95714c2ce}{bus\_type\_t}})) \{}
\DoxyCodeLine{36             *ptr++ = \mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_aacad53049524692810e6f78545bb4ae9}{\_if}}-\/>\_rd(offs + i);}
\DoxyCodeLine{37         \}}
\DoxyCodeLine{38         \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{39     \}}
\DoxyCodeLine{40 }
\DoxyCodeLine{46     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_ac341f9545ab4777642db8b1b04616b36}{\_wr}}(uint32\_t offs, \textcolor{keyword}{const} C\& value) \{}
\DoxyCodeLine{47         \textcolor{keyword}{const} \mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_a15e3cc0b449b7630cbee38f95714c2ce}{bus\_type\_t}}* ptr = \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const }\mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_a15e3cc0b449b7630cbee38f95714c2ce}{bus\_type\_t}}*\textcolor{keyword}{>}(\&value);}
\DoxyCodeLine{48         \textcolor{keywordflow}{for} (uint32\_t i = 0; i < \textcolor{keyword}{sizeof}(C); i += \textcolor{keyword}{sizeof}(\mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_a15e3cc0b449b7630cbee38f95714c2ce}{bus\_type\_t}})) \{}
\DoxyCodeLine{49             \mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_aacad53049524692810e6f78545bb4ae9}{\_if}}-\/>\_wr(offs + i, *ptr++);}
\DoxyCodeLine{50         \}}
\DoxyCodeLine{51     \}}
\DoxyCodeLine{52 }
\DoxyCodeLine{53   \textcolor{keyword}{public}:}
\DoxyCodeLine{54     \textcolor{keyword}{using }\mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_a9f25adb8e63a3643c3759a70c55e9b60}{constructor\_arg\_type}} = U*;}
\DoxyCodeLine{55 }
\DoxyCodeLine{56     \mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_ae9f59e8700168bf999053944c48cc340}{RegAccessorBase}}() = \textcolor{keyword}{delete};}
\DoxyCodeLine{57 }
\DoxyCodeLine{62     \mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_a9b6f5d7b942e57fc42d0de842cfcd514}{RegAccessorBase}}(\mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_a9f25adb8e63a3643c3759a70c55e9b60}{constructor\_arg\_type}} interface) : \mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_aacad53049524692810e6f78545bb4ae9}{\_if}}\{interface\} \{\}}
\DoxyCodeLine{63 \};}
\DoxyCodeLine{64 }
\DoxyCodeLine{70 \textcolor{keyword}{template} <\textcolor{keyword}{typename} C, \textcolor{keyword}{typename} U>}
\DoxyCodeLine{71 \textcolor{keyword}{class }\mbox{\hyperlink{classudmaio_1_1_reg_accessor_array_element}{RegAccessorArrayElement}} : \textcolor{keyword}{public} \mbox{\hyperlink{classudmaio_1_1_reg_accessor_base}{RegAccessorBase}}<C, U> \{}
\DoxyCodeLine{72     \textcolor{keyword}{const} uint32\_t \mbox{\hyperlink{classudmaio_1_1_reg_accessor_array_element_a51743efe3039af2247498ba649d4dd7c}{\_reg\_offs}};}
\DoxyCodeLine{73 }
\DoxyCodeLine{74   \textcolor{keyword}{public}:}
\DoxyCodeLine{80     \mbox{\hyperlink{classudmaio_1_1_reg_accessor_array_element_ac47f6a38fe9b22c973e3a59647c60f33}{RegAccessorArrayElement}}(\textcolor{keyword}{typename} \mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_a9f25adb8e63a3643c3759a70c55e9b60}{RegAccessorBase<C, U>::constructor\_arg\_type}} c,}
\DoxyCodeLine{81                             uint32\_t reg\_offs)}
\DoxyCodeLine{82         : \mbox{\hyperlink{classudmaio_1_1_reg_accessor_base}{RegAccessorBase}}<C, U>\{c\}, \mbox{\hyperlink{classudmaio_1_1_reg_accessor_array_element_a51743efe3039af2247498ba649d4dd7c}{\_reg\_offs}}\{reg\_offs\} \{\}}
\DoxyCodeLine{83 }
\DoxyCodeLine{88     C \mbox{\hyperlink{classudmaio_1_1_reg_accessor_array_element_a363921e50105a6e629a731a809d432d8}{rd}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_a6533971f0b802d7a96e57621e1e585c7}{RegAccessorBase<C, U>::\_rd}}(\mbox{\hyperlink{classudmaio_1_1_reg_accessor_array_element_a51743efe3039af2247498ba649d4dd7c}{\_reg\_offs}}); \}}
\DoxyCodeLine{89 }
\DoxyCodeLine{94     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudmaio_1_1_reg_accessor_array_element_a00d22a593d3505ad3d395ee015a42ff4}{wr}}(\textcolor{keyword}{const} C\& value) \{ \mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_ac341f9545ab4777642db8b1b04616b36}{RegAccessorBase<C, U>::\_wr}}(\mbox{\hyperlink{classudmaio_1_1_reg_accessor_array_element_a51743efe3039af2247498ba649d4dd7c}{\_reg\_offs}}, value); \}}
\DoxyCodeLine{95 \};}
\DoxyCodeLine{96 }
\DoxyCodeLine{105 \textcolor{keyword}{template} <\textcolor{keyword}{typename} C, \textcolor{keyword}{typename} U, u\textcolor{keywordtype}{int}32\_t offset, u\textcolor{keywordtype}{int}32\_t arr\_size, u\textcolor{keywordtype}{int}32\_t arr\_str\textcolor{keywordtype}{id}e>}
\DoxyCodeLine{106 \textcolor{keyword}{class }\mbox{\hyperlink{classudmaio_1_1_reg_accessor_array}{RegAccessorArray}} : \textcolor{keyword}{public} \mbox{\hyperlink{classudmaio_1_1_reg_accessor_base}{RegAccessorBase}}<C, U> \{}
\DoxyCodeLine{107     \textcolor{keyword}{static\_assert}((offset \% \textcolor{keyword}{sizeof}(\textcolor{keyword}{typename} U::UioIfBusType)) == 0,}
\DoxyCodeLine{108                   \textcolor{stringliteral}{"{}Register array offset must be aligned to bus access width"{}});}
\DoxyCodeLine{109     \textcolor{keyword}{static\_assert}(arr\_size > 0, \textcolor{stringliteral}{"{}Register array size must be non-\/zero"{}});}
\DoxyCodeLine{110     \textcolor{keyword}{static\_assert}((arr\_stride \% \textcolor{keyword}{sizeof}(\textcolor{keyword}{typename} U::UioIfBusType)) == 0,}
\DoxyCodeLine{111                   \textcolor{stringliteral}{"{}Register array stride must be aligned to bus access width"{}});}
\DoxyCodeLine{112 }
\DoxyCodeLine{113   \textcolor{keyword}{public}:}
\DoxyCodeLine{114     \textcolor{keyword}{using }\mbox{\hyperlink{classudmaio_1_1_reg_accessor_base}{RegAccessorBase}}<C, U>\mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_ae9f59e8700168bf999053944c48cc340}{::RegAccessorBase}};}
\DoxyCodeLine{115 }
\DoxyCodeLine{121     \mbox{\hyperlink{classudmaio_1_1_reg_accessor_array_element}{RegAccessorArrayElement<C, U>}} \mbox{\hyperlink{classudmaio_1_1_reg_accessor_array_aaeb9c859634ac7899ca8dfbbd9bf2653}{operator[]}}(uint32\_t idx) \{}
\DoxyCodeLine{122         assert(idx < arr\_size);}
\DoxyCodeLine{123         \textcolor{keyword}{const} uint32\_t reg\_offs = offset + idx * arr\_stride;}
\DoxyCodeLine{124         \textcolor{keywordflow}{return} \mbox{\hyperlink{classudmaio_1_1_reg_accessor_array_element}{RegAccessorArrayElement<C, U>}}\{\mbox{\hyperlink{classudmaio_1_1_reg_accessor_base}{RegAccessorBase<C, U>::\_if}}, reg\_offs\};}
\DoxyCodeLine{125     \}}
\DoxyCodeLine{126 }
\DoxyCodeLine{131     \textcolor{keyword}{constexpr} uint32\_t \mbox{\hyperlink{classudmaio_1_1_reg_accessor_array_a89a77f0790dc9d269e3a428f1b858d60}{size}}() \{ \textcolor{keywordflow}{return} arr\_size; \}}
\DoxyCodeLine{132 \};}
\DoxyCodeLine{133 }
\DoxyCodeLine{140 \textcolor{keyword}{template} <\textcolor{keyword}{typename} C, \textcolor{keyword}{typename} U, u\textcolor{keywordtype}{int}32\_t offset>}
\DoxyCodeLine{141 \textcolor{keyword}{class }\mbox{\hyperlink{classudmaio_1_1_reg_accessor_array}{RegAccessorArray}}<C, U, offset, 0, 0> : \textcolor{keyword}{public} \mbox{\hyperlink{classudmaio_1_1_reg_accessor_base}{RegAccessorBase}}<C, U> \{}
\DoxyCodeLine{142     \textcolor{keyword}{static\_assert}((offset \% \textcolor{keyword}{sizeof}(\textcolor{keyword}{typename} U::UioIfBusType)) == 0,}
\DoxyCodeLine{143                   \textcolor{stringliteral}{"{}Register offset must be aligned to bus width"{}});}
\DoxyCodeLine{144 }
\DoxyCodeLine{145   \textcolor{keyword}{public}:}
\DoxyCodeLine{146     \textcolor{keyword}{using }\mbox{\hyperlink{classudmaio_1_1_reg_accessor_base}{RegAccessorBase}}<C, U>\mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_ae9f59e8700168bf999053944c48cc340}{::RegAccessorBase}};}
\DoxyCodeLine{147 }
\DoxyCodeLine{152     C \mbox{\hyperlink{classudmaio_1_1_reg_accessor_array_3_01_c_00_01_u_00_01offset_00_010_00_010_01_4_aaa375c468ba48448a76c43cbea2e6ebe}{rd}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_a6533971f0b802d7a96e57621e1e585c7}{RegAccessorBase<C, U>::\_rd}}(offset); \}}
\DoxyCodeLine{153 }
\DoxyCodeLine{158     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudmaio_1_1_reg_accessor_array_3_01_c_00_01_u_00_01offset_00_010_00_010_01_4_a70daf4b61a25927ff34b55d10fb53aa9}{wr}}(\textcolor{keyword}{const} C\& value) \{ \mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_ac341f9545ab4777642db8b1b04616b36}{RegAccessorBase<C, U>::\_wr}}(offset, value); \}}
\DoxyCodeLine{159 \};}
\DoxyCodeLine{160 }
\DoxyCodeLine{166 \textcolor{keyword}{template} <\textcolor{keyword}{typename} C, u\textcolor{keywordtype}{int}32\_t offset>}
\DoxyCodeLine{167 \textcolor{keyword}{using }\mbox{\hyperlink{classudmaio_1_1_reg_accessor_array}{RegAccessor32}} = \mbox{\hyperlink{classudmaio_1_1_reg_accessor_array}{RegAccessorArray<C, UioIf<uint32\_t>}}, offset, 0, 0>;}
\DoxyCodeLine{168 \textcolor{keyword}{template} <\textcolor{keyword}{typename} C, u\textcolor{keywordtype}{int}32\_t offset>}
\DoxyCodeLine{169 \textcolor{keyword}{using }\mbox{\hyperlink{classudmaio_1_1_reg_accessor_array}{RegAccessor64}} = \mbox{\hyperlink{classudmaio_1_1_reg_accessor_array}{RegAccessorArray<C, UioIf<uint64\_t>}}, offset, 0, 0>;}
\DoxyCodeLine{170 }
\DoxyCodeLine{171 \textcolor{keyword}{template} <\textcolor{keyword}{typename} C, u\textcolor{keywordtype}{int}32\_t offset, u\textcolor{keywordtype}{int}32\_t arr\_size, u\textcolor{keywordtype}{int}32\_t arr\_str\textcolor{keywordtype}{id}e>}
\DoxyCodeLine{172 \textcolor{keyword}{using }\mbox{\hyperlink{classudmaio_1_1_reg_accessor_array}{RegAccessorArray32}} = \mbox{\hyperlink{classudmaio_1_1_reg_accessor_array}{RegAccessorArray<C, UioIf<uint32\_t>}}, offset, arr\_size, arr\_stride>;}
\DoxyCodeLine{173 \textcolor{keyword}{template} <\textcolor{keyword}{typename} C, u\textcolor{keywordtype}{int}32\_t offset, u\textcolor{keywordtype}{int}32\_t arr\_size, u\textcolor{keywordtype}{int}32\_t arr\_str\textcolor{keywordtype}{id}e>}
\DoxyCodeLine{174 \textcolor{keyword}{using }\mbox{\hyperlink{classudmaio_1_1_reg_accessor_array}{RegAccessorArray64}} = \mbox{\hyperlink{classudmaio_1_1_reg_accessor_array}{RegAccessorArray<C, UioIf<uint64\_t>}}, offset, arr\_size, arr\_stride>;}
\DoxyCodeLine{175 }
\DoxyCodeLine{183 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{184 std::string \mbox{\hyperlink{namespaceudmaio_a5c03c63d910348e26da90a894fc7242e}{field\_to\_str}}(\textcolor{keyword}{const} T\& chararray) \{}
\DoxyCodeLine{185     \textcolor{keywordflow}{return} \{chararray, strnlen(chararray, \textcolor{keyword}{sizeof}(chararray))\};}
\DoxyCodeLine{186 \}}
\DoxyCodeLine{187 }
\DoxyCodeLine{188 \}  \textcolor{comment}{// namespace udmaio}}

\end{DoxyCode}
