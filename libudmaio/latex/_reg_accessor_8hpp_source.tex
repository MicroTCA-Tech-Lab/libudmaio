\hypertarget{_reg_accessor_8hpp_source}{}\doxysection{Reg\+Accessor.\+hpp}
\label{_reg_accessor_8hpp_source}\index{RegAccessor.hpp@{RegAccessor.hpp}}
\mbox{\hyperlink{_reg_accessor_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{2 }
\DoxyCodeLine{3 \textcolor{preprocessor}{\#include <cstdint>}}
\DoxyCodeLine{4 }
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_uio_if_8hpp}{udmaio/UioIf.hpp}}"{}}}
\DoxyCodeLine{6 }
\DoxyCodeLine{7 \textcolor{preprocessor}{\#ifndef REG\_PACKED\_ALIGNED}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#define REG\_PACKED\_ALIGNED \_\_attribute\_\_((packed, aligned(4)))}}
\DoxyCodeLine{9 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10 }
\DoxyCodeLine{11 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceudmaio}{udmaio}} \{}
\DoxyCodeLine{12 }
\DoxyCodeLine{17 \textcolor{keyword}{template} <\textcolor{keyword}{typename} C>}
\DoxyCodeLine{18 \textcolor{keyword}{class }\mbox{\hyperlink{classudmaio_1_1_reg_accessor_base}{RegAccessorBase}} \{}
\DoxyCodeLine{19     \textcolor{keyword}{static\_assert}((\textcolor{keyword}{sizeof}(C) \% \textcolor{keyword}{sizeof}(uint32\_t)) == 0,}
\DoxyCodeLine{20                   \textcolor{stringliteral}{"{}Register size must be a aligned to 32 bits"{}});}
\DoxyCodeLine{21 }
\DoxyCodeLine{22   \textcolor{keyword}{protected}:}
\DoxyCodeLine{23     \mbox{\hyperlink{classudmaio_1_1_uio_if}{UioIf}}* \mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_a4067a4efbfab68504bf00063b389eb93}{\_if}};}
\DoxyCodeLine{24 }
\DoxyCodeLine{30     C \mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_ac48b43f437837cd965706d4c7626b2b9}{\_rd}}(uint32\_t offs)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{31         C result;}
\DoxyCodeLine{32         uint32\_t* ptr = \textcolor{keyword}{reinterpret\_cast<}uint32\_t*\textcolor{keyword}{>}(\&result);}
\DoxyCodeLine{33         \textcolor{keywordflow}{for} (uint32\_t i = 0; i < \textcolor{keyword}{sizeof}(C); i += \textcolor{keyword}{sizeof}(uint32\_t)) \{}
\DoxyCodeLine{34             *ptr++ = \mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_a4067a4efbfab68504bf00063b389eb93}{\_if}}-\/>\mbox{\hyperlink{classudmaio_1_1_uio_if_a9a7d60c6438b2d90e204bb5a456ed755}{\_rd32}}(offs + i);}
\DoxyCodeLine{35         \}}
\DoxyCodeLine{36         \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{37     \}}
\DoxyCodeLine{38 }
\DoxyCodeLine{44     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_a7107c7f25cb16b638ae56903c7803837}{\_wr}}(uint32\_t offs, \textcolor{keyword}{const} C\& value) \{}
\DoxyCodeLine{45         \textcolor{keyword}{const} uint32\_t* ptr = \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const }uint32\_t*\textcolor{keyword}{>}(\&value);}
\DoxyCodeLine{46         \textcolor{keywordflow}{for} (uint32\_t i = 0; i < \textcolor{keyword}{sizeof}(C); i += \textcolor{keyword}{sizeof}(uint32\_t)) \{}
\DoxyCodeLine{47             \mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_a4067a4efbfab68504bf00063b389eb93}{\_if}}-\/>\mbox{\hyperlink{classudmaio_1_1_uio_if_a493e161ddcaa28c256f075f45e687391}{\_wr32}}(offs + i, *ptr++);}
\DoxyCodeLine{48         \}}
\DoxyCodeLine{49     \}}
\DoxyCodeLine{50 }
\DoxyCodeLine{51   \textcolor{keyword}{public}:}
\DoxyCodeLine{52     \textcolor{keyword}{using }\mbox{\hyperlink{classudmaio_1_1_uio_if}{constructor\_arg\_type}} = \mbox{\hyperlink{classudmaio_1_1_uio_if}{UioIf}}*;}
\DoxyCodeLine{53 }
\DoxyCodeLine{54     \mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_ad878857665ec6cb11fb5133240a23e65}{RegAccessorBase}}() = \textcolor{keyword}{delete};}
\DoxyCodeLine{55 }
\DoxyCodeLine{60     \mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_a7298226a53b233dd99ca2dec3e41d109}{RegAccessorBase}}(\mbox{\hyperlink{classudmaio_1_1_uio_if}{constructor\_arg\_type}} interface) : \mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_a4067a4efbfab68504bf00063b389eb93}{\_if}}\{interface\} \{\}}
\DoxyCodeLine{61 \};}
\DoxyCodeLine{62 }
\DoxyCodeLine{67 \textcolor{keyword}{template} <\textcolor{keyword}{typename} C>}
\DoxyCodeLine{68 \textcolor{keyword}{class }\mbox{\hyperlink{classudmaio_1_1_reg_accessor_array_element}{RegAccessorArrayElement}} : \textcolor{keyword}{public} \mbox{\hyperlink{classudmaio_1_1_reg_accessor_base}{RegAccessorBase}}<C> \{}
\DoxyCodeLine{69     \textcolor{keyword}{static\_assert}((\textcolor{keyword}{sizeof}(C) \% \textcolor{keyword}{sizeof}(uint32\_t)) == 0, \textcolor{stringliteral}{"{}Register size must be aligned to 32 bits"{}});}
\DoxyCodeLine{70 }
\DoxyCodeLine{71     \textcolor{keyword}{const} uint32\_t \mbox{\hyperlink{classudmaio_1_1_reg_accessor_array_element_a03956a268d070b2be79f9c1dd4173ce5}{\_reg\_offs}};}
\DoxyCodeLine{72 }
\DoxyCodeLine{73   \textcolor{keyword}{public}:}
\DoxyCodeLine{79     \mbox{\hyperlink{classudmaio_1_1_reg_accessor_array_element_aaa4e2dac359c1b0ed94316ca5a24727b}{RegAccessorArrayElement}}(\textcolor{keyword}{typename} \mbox{\hyperlink{classudmaio_1_1_uio_if}{RegAccessorBase<C>::constructor\_arg\_type}} c, uint32\_t reg\_offs)}
\DoxyCodeLine{80         : \mbox{\hyperlink{classudmaio_1_1_reg_accessor_base}{RegAccessorBase}}<C>\{c\}, \mbox{\hyperlink{classudmaio_1_1_reg_accessor_array_element_a03956a268d070b2be79f9c1dd4173ce5}{\_reg\_offs}}\{reg\_offs\} \{\}}
\DoxyCodeLine{81 }
\DoxyCodeLine{86     C \mbox{\hyperlink{classudmaio_1_1_reg_accessor_array_element_ae54bc577dd3b1006870b046116278d96}{rd}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_ac48b43f437837cd965706d4c7626b2b9}{RegAccessorBase<C>::\_rd}}(\mbox{\hyperlink{classudmaio_1_1_reg_accessor_array_element_a03956a268d070b2be79f9c1dd4173ce5}{\_reg\_offs}}); \}}
\DoxyCodeLine{87 }
\DoxyCodeLine{92     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudmaio_1_1_reg_accessor_array_element_adab9bc37d421d67e94015a8a5f0ee9d3}{wr}}(\textcolor{keyword}{const} C\& value) \{ \mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_a7107c7f25cb16b638ae56903c7803837}{RegAccessorBase<C>::\_wr}}(\mbox{\hyperlink{classudmaio_1_1_reg_accessor_array_element_a03956a268d070b2be79f9c1dd4173ce5}{\_reg\_offs}}, value); \}}
\DoxyCodeLine{93 \};}
\DoxyCodeLine{94 }
\DoxyCodeLine{102 \textcolor{keyword}{template} <\textcolor{keyword}{typename} C, u\textcolor{keywordtype}{int}32\_t offset, u\textcolor{keywordtype}{int}32\_t arr\_size, u\textcolor{keywordtype}{int}32\_t arr\_str\textcolor{keywordtype}{id}e>}
\DoxyCodeLine{103 \textcolor{keyword}{class }\mbox{\hyperlink{classudmaio_1_1_reg_accessor_array}{RegAccessorArray}} : \textcolor{keyword}{public} \mbox{\hyperlink{classudmaio_1_1_reg_accessor_base}{RegAccessorBase}}<C> \{}
\DoxyCodeLine{104     \textcolor{keyword}{static\_assert}((\textcolor{keyword}{sizeof}(C) \% \textcolor{keyword}{sizeof}(uint32\_t)) == 0, \textcolor{stringliteral}{"{}Register size must be aligned to 32 bits"{}});}
\DoxyCodeLine{105     \textcolor{keyword}{static\_assert}((offset \% \textcolor{keyword}{sizeof}(uint32\_t)) == 0,}
\DoxyCodeLine{106                   \textcolor{stringliteral}{"{}Register array offset must be aligned to 32 bits"{}});}
\DoxyCodeLine{107     \textcolor{keyword}{static\_assert}(arr\_size > 0, \textcolor{stringliteral}{"{}Register array size must be non-\/zero"{}});}
\DoxyCodeLine{108     \textcolor{keyword}{static\_assert}((arr\_stride \% \textcolor{keyword}{sizeof}(uint32\_t)) == 0,}
\DoxyCodeLine{109                   \textcolor{stringliteral}{"{}Register array stride must be aligned to 32 bits"{}});}
\DoxyCodeLine{110 }
\DoxyCodeLine{111   \textcolor{keyword}{public}:}
\DoxyCodeLine{112     \textcolor{keyword}{using }\mbox{\hyperlink{classudmaio_1_1_reg_accessor_base}{RegAccessorBase}}<C>\mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_ad878857665ec6cb11fb5133240a23e65}{::RegAccessorBase}};}
\DoxyCodeLine{113 }
\DoxyCodeLine{119     \mbox{\hyperlink{classudmaio_1_1_reg_accessor_array_element}{RegAccessorArrayElement<C>}} \mbox{\hyperlink{classudmaio_1_1_reg_accessor_array_a4b8a2afd9ba4baefa3f4e218bc0dc020}{operator[]}}(uint32\_t idx) \{}
\DoxyCodeLine{120         assert(idx < arr\_size);}
\DoxyCodeLine{121         \textcolor{keyword}{const} uint32\_t reg\_offs = offset + idx * arr\_stride;}
\DoxyCodeLine{122         \textcolor{keywordflow}{return} \mbox{\hyperlink{classudmaio_1_1_reg_accessor_array_element}{RegAccessorArrayElement<C>}}\{\mbox{\hyperlink{classudmaio_1_1_reg_accessor_base}{RegAccessorBase<C>::\_if}}, reg\_offs\};}
\DoxyCodeLine{123     \}}
\DoxyCodeLine{124 }
\DoxyCodeLine{129     \textcolor{keyword}{constexpr} uint32\_t \mbox{\hyperlink{classudmaio_1_1_reg_accessor_array_a488582212ef79d90b08842feb6ec876b}{size}}() \{ \textcolor{keywordflow}{return} arr\_size; \}}
\DoxyCodeLine{130 \};}
\DoxyCodeLine{131 }
\DoxyCodeLine{137 \textcolor{keyword}{template} <\textcolor{keyword}{typename} C, u\textcolor{keywordtype}{int}32\_t offset>}
\DoxyCodeLine{138 \textcolor{keyword}{class }\mbox{\hyperlink{classudmaio_1_1_reg_accessor_array}{RegAccessorArray}}<C, offset, 0, 0> : \textcolor{keyword}{public} \mbox{\hyperlink{classudmaio_1_1_reg_accessor_base}{RegAccessorBase}}<C> \{}
\DoxyCodeLine{139     \textcolor{keyword}{static\_assert}((\textcolor{keyword}{sizeof}(C) \% \textcolor{keyword}{sizeof}(uint32\_t)) == 0, \textcolor{stringliteral}{"{}Register size must be aligned to 32 bits"{}});}
\DoxyCodeLine{140     \textcolor{keyword}{static\_assert}((offset \% \textcolor{keyword}{sizeof}(uint32\_t)) == 0, \textcolor{stringliteral}{"{}Register offset must be aligned to 32 bits"{}});}
\DoxyCodeLine{141 }
\DoxyCodeLine{142   \textcolor{keyword}{public}:}
\DoxyCodeLine{143     \textcolor{keyword}{using }\mbox{\hyperlink{classudmaio_1_1_reg_accessor_base}{RegAccessorBase}}<C>\mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_ad878857665ec6cb11fb5133240a23e65}{::RegAccessorBase}};}
\DoxyCodeLine{144 }
\DoxyCodeLine{149     C \mbox{\hyperlink{classudmaio_1_1_reg_accessor_array_3_01_c_00_01offset_00_010_00_010_01_4_ab7a42dc9e810b80b4ed294730414ec11}{rd}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_ac48b43f437837cd965706d4c7626b2b9}{RegAccessorBase<C>::\_rd}}(offset); \}}
\DoxyCodeLine{150 }
\DoxyCodeLine{155     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudmaio_1_1_reg_accessor_array_3_01_c_00_01offset_00_010_00_010_01_4_a39bd8f92c5a373086119460ccde63746}{wr}}(\textcolor{keyword}{const} C\& value) \{ \mbox{\hyperlink{classudmaio_1_1_reg_accessor_base_a7107c7f25cb16b638ae56903c7803837}{RegAccessorBase<C>::\_wr}}(offset, value); \}}
\DoxyCodeLine{156 \};}
\DoxyCodeLine{157 }
\DoxyCodeLine{163 \textcolor{keyword}{template} <\textcolor{keyword}{typename} C, u\textcolor{keywordtype}{int}32\_t offset>}
\DoxyCodeLine{164 \textcolor{keyword}{using }\mbox{\hyperlink{classudmaio_1_1_reg_accessor_array_3_01_c_00_01offset_00_010_00_010_01_4}{RegAccessor}} = \mbox{\hyperlink{classudmaio_1_1_reg_accessor_array}{RegAccessorArray<C, offset, 0, 0>}};}
\DoxyCodeLine{165 }
\DoxyCodeLine{173 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{174 std::string \mbox{\hyperlink{namespaceudmaio_a5c03c63d910348e26da90a894fc7242e}{field\_to\_str}}(\textcolor{keyword}{const} T\& chararray) \{}
\DoxyCodeLine{175     \textcolor{keywordflow}{return} \{chararray, strnlen(chararray, \textcolor{keyword}{sizeof}(chararray))\};}
\DoxyCodeLine{176 \}}
\DoxyCodeLine{177 }
\DoxyCodeLine{178 \}  \textcolor{comment}{// namespace udmaio}}

\end{DoxyCode}
