\hypertarget{_uio_if_8hpp_source}{}\doxysection{Uio\+If.\+hpp}
\label{_uio_if_8hpp_source}\index{UioIf.hpp@{UioIf.hpp}}
\mbox{\hyperlink{_uio_if_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\///}}
\DoxyCodeLine{2 \textcolor{comment}{//        \_\_\_\_  \_\_\_\_\_\_\_\_\_\_\_\_\_  \_\_    \_\_  \_\_ \_           \_\_\_\_\_ \_\_\_   \_        //}}
\DoxyCodeLine{3 \textcolor{comment}{//       / \_\_ \(\backslash\)/ \_\_\_\_/ \_\_\_/\(\backslash\) \(\backslash\)/ /   |  \(\backslash\)/  (\_)\_\_ \_ \_ \_\_|\_   \_/ \_\_| /\_\(\backslash\)       //}}
\DoxyCodeLine{4 \textcolor{comment}{//      / / / / \_\_/  \(\backslash\)\_\_ \(\backslash\)  \(\backslash\)  /    | |\(\backslash\)/| | / \_| '\_/ \_ \(\backslash\)| || (\_\_ / \_ \(\backslash\)      //}}
\DoxyCodeLine{5 \textcolor{comment}{//     / /\_/ / /\_\_\_ \_\_\_/ /  / /     |\_|  |\_|\_\(\backslash\)\_\_|\_| \(\backslash\)\_\_\_/|\_| \(\backslash\)\_\_\_/\_/ \(\backslash\)\_\(\backslash\)     //}}
\DoxyCodeLine{6 \textcolor{comment}{//    /\_\_\_\_\_/\_\_\_\_\_//\_\_\_\_/  /\_/      T  E  C  H  N  O  L  O  G  Y   L A B     //}}
\DoxyCodeLine{7 \textcolor{comment}{//                                                                           //}}
\DoxyCodeLine{8 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\///}}
\DoxyCodeLine{9 }
\DoxyCodeLine{10 \textcolor{comment}{// Copyright (c) 2021 Deutsches Elektronen-\/Synchrotron DESY}}
\DoxyCodeLine{11 }
\DoxyCodeLine{12 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{13 }
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_uio_if_base_8hpp}{udmaio/UioIfBase.hpp}}"{}}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceudmaio}{udmaio}} \{}
\DoxyCodeLine{17 }
\DoxyCodeLine{22 \textcolor{keyword}{template} <\textcolor{keyword}{typename} bus\_type\_t>}
\DoxyCodeLine{23 \textcolor{keyword}{class }\mbox{\hyperlink{classudmaio_1_1_uio_if}{UioIf}} : \textcolor{keyword}{public} \mbox{\hyperlink{classudmaio_1_1_uio_if_base}{UioIfBase}} \{}
\DoxyCodeLine{24     \textcolor{keyword}{static\_assert}(\textcolor{keyword}{sizeof}(bus\_type\_t) == \textcolor{keyword}{sizeof}(uint32\_t) || \textcolor{keyword}{sizeof}(bus\_type\_t) == \textcolor{keyword}{sizeof}(uint64\_t),}
\DoxyCodeLine{25                   \textcolor{stringliteral}{"{}Bus access width must be 32 or 64 bits"{}});}
\DoxyCodeLine{26 }
\DoxyCodeLine{27   \textcolor{keyword}{public}:}
\DoxyCodeLine{28     \textcolor{keyword}{using }\mbox{\hyperlink{classudmaio_1_1_uio_if_base_a594dc74763500f1162c98d23fc66b589}{UioIfBase::UioIfBase}};}
\DoxyCodeLine{29     \textcolor{keyword}{virtual} \mbox{\hyperlink{classudmaio_1_1_uio_if_a04e5a62b29a0684197ad7de27019aff5}{\string~UioIf}}()\{\};}
\DoxyCodeLine{30 }
\DoxyCodeLine{31   \textcolor{keyword}{protected}:}
\DoxyCodeLine{32     \textcolor{keyword}{inline} \textcolor{keyword}{volatile} bus\_type\_t* \mbox{\hyperlink{classudmaio_1_1_uio_if_a3ba493c5afb7aa69dedd68f2d235146a}{\_reg\_ptr}}(uint32\_t offs)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{33         \textcolor{keywordflow}{return} \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{volatile }bus\_type\_t*\textcolor{keyword}{>}(\textcolor{keyword}{static\_cast<}uint8\_t*\textcolor{keyword}{>}(\mbox{\hyperlink{classudmaio_1_1_uio_if_base_af085ebb3a6eb65d5b97e12c11eb976e0}{\_mem}}) +}
\DoxyCodeLine{34                                                       \textcolor{keyword}{static\_cast<}ptrdiff\_t\textcolor{keyword}{>}(offs));}
\DoxyCodeLine{35     \}}
\DoxyCodeLine{36 }
\DoxyCodeLine{37     bus\_type\_t \mbox{\hyperlink{classudmaio_1_1_uio_if_af4c53f60c84950f770eb8ae9ecbe9ca1}{\_rd}}(uint32\_t offs)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{38         bus\_type\_t tmp = *\mbox{\hyperlink{classudmaio_1_1_uio_if_a3ba493c5afb7aa69dedd68f2d235146a}{\_reg\_ptr}}(offs);}
\DoxyCodeLine{39         BOOST\_LOG\_SEV(\mbox{\hyperlink{classudmaio_1_1_uio_if_base_a5076f78b2e6d1417e56bee0fb5e2d0de}{\_slg}}, blt::severity\_level::trace)}
\DoxyCodeLine{40             << \mbox{\hyperlink{classudmaio_1_1_uio_if_base_adc4c1d9a03e87af0b9a853bb45c5bd62}{\_log\_name}}() << \textcolor{stringliteral}{"{}: read at 0x"{}} << std::hex << offs << \textcolor{stringliteral}{"{} = 0x"{}} << tmp << std::dec;}
\DoxyCodeLine{41         \textcolor{keywordflow}{return} tmp;}
\DoxyCodeLine{42     \}}
\DoxyCodeLine{43 }
\DoxyCodeLine{44     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudmaio_1_1_uio_if_af98e8c2719202c10ab29d9eddfa37bb8}{\_wr}}(uint32\_t offs, bus\_type\_t data) \{}
\DoxyCodeLine{45         BOOST\_LOG\_SEV(\mbox{\hyperlink{classudmaio_1_1_uio_if_base_a5076f78b2e6d1417e56bee0fb5e2d0de}{\_slg}}, blt::severity\_level::trace)}
\DoxyCodeLine{46             << \mbox{\hyperlink{classudmaio_1_1_uio_if_base_adc4c1d9a03e87af0b9a853bb45c5bd62}{\_log\_name}}() << \textcolor{stringliteral}{"{}: write at 0x"{}} << std::hex << offs << \textcolor{stringliteral}{"{} = 0x"{}} << data << std::dec;}
\DoxyCodeLine{47         *\mbox{\hyperlink{classudmaio_1_1_uio_if_a3ba493c5afb7aa69dedd68f2d235146a}{\_reg\_ptr}}(offs) = data;}
\DoxyCodeLine{48     \}}
\DoxyCodeLine{49 }
\DoxyCodeLine{50     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudmaio_1_1_uio_if_a4ac244b81986fd286e1ae116bda56644}{\_rd\_mem}}(uint32\_t offs, \textcolor{keywordtype}{void}* \_\_restrict\_\_ mem, \textcolor{keywordtype}{size\_t} size)\textcolor{keyword}{ const override }\{}
\DoxyCodeLine{51         assert((offs \% \textcolor{keyword}{sizeof}(bus\_type\_t)) == 0);}
\DoxyCodeLine{52         assert((size \% \textcolor{keyword}{sizeof}(bus\_type\_t)) == 0);}
\DoxyCodeLine{53         bus\_type\_t* \_\_restrict\_\_ ptr = \textcolor{keyword}{reinterpret\_cast<}bus\_type\_t*\textcolor{keyword}{>}(mem);}
\DoxyCodeLine{54         \textcolor{keywordflow}{for} (uint32\_t i = 0; i < size; i += \textcolor{keyword}{sizeof}(bus\_type\_t)) \{}
\DoxyCodeLine{55             *ptr++ = \mbox{\hyperlink{classudmaio_1_1_uio_if_af4c53f60c84950f770eb8ae9ecbe9ca1}{\_rd}}(offs + i);}
\DoxyCodeLine{56         \}}
\DoxyCodeLine{57     \}}
\DoxyCodeLine{58 }
\DoxyCodeLine{59     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudmaio_1_1_uio_if_a92b5d432aee1faa8477d1f4c71c2bbc4}{\_wr\_mem}}(uint32\_t offs, \textcolor{keyword}{const} \textcolor{keywordtype}{void}* \_\_restrict\_\_ mem, \textcolor{keywordtype}{size\_t} size)\textcolor{keyword}{ override }\{}
\DoxyCodeLine{60         assert((offs \% \textcolor{keyword}{sizeof}(bus\_type\_t)) == 0);}
\DoxyCodeLine{61         assert((size \% \textcolor{keyword}{sizeof}(bus\_type\_t)) == 0);}
\DoxyCodeLine{62         \textcolor{keyword}{const} bus\_type\_t* \_\_restrict\_\_ ptr = \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const }bus\_type\_t*\textcolor{keyword}{>}(mem);}
\DoxyCodeLine{63         \textcolor{keywordflow}{for} (uint32\_t i = 0; i < size; i += \textcolor{keyword}{sizeof}(bus\_type\_t)) \{}
\DoxyCodeLine{64             \mbox{\hyperlink{classudmaio_1_1_uio_if_af98e8c2719202c10ab29d9eddfa37bb8}{\_wr}}(offs + i, *ptr++);}
\DoxyCodeLine{65         \}}
\DoxyCodeLine{66     \}}
\DoxyCodeLine{67 \};}
\DoxyCodeLine{68 }
\DoxyCodeLine{69 \textcolor{keyword}{using }\mbox{\hyperlink{classudmaio_1_1_uio_if}{UioIf32}} = \mbox{\hyperlink{classudmaio_1_1_uio_if}{UioIf<uint32\_t>}};}
\DoxyCodeLine{70 \textcolor{keyword}{using }\mbox{\hyperlink{classudmaio_1_1_uio_if}{UioIf64}} = \mbox{\hyperlink{classudmaio_1_1_uio_if}{UioIf<uint64\_t>}};}
\DoxyCodeLine{71 }
\DoxyCodeLine{72 \}  \textcolor{comment}{// namespace udmaio}}

\end{DoxyCode}
